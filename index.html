<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Tic Tac Toe with Computer</title>
  </head>
  <body>
    <div class="container">
      <div class="board">
        <div class="box x1"></div>
        <div class="box x2"></div>
        <div class="box x3"></div>
        <div class="box x4"></div>
        <div class="box x5"></div>
        <div class="box x6"></div>
        <div class="box x7"></div>
        <div class="box x8"></div>
        <div class="box x9"></div>
      </div>
      <div class="console">
      </div>
    </div>
    <script>
window.games = [];
window.game = [];

function addMessage(text, level) {
  // Append a message in the console
  var msg = "<p class=' " + level +"'>" + text + "</p>";
  var console = document.querySelector('.console');
  console.innerHTML += msg;
}

function getRandomInt(min, max) {
  // Get a random number between min and max
  addMessage("Generating random number.", "level5");
  return Math.floor(Math.random() * max) + min;
}

function lastMove() {
  // Get the order of lastest move in the game
  return window.game.length - 1;
}

function lastPosition() {
  // Get the latest position filled in the board
  return window.game[lastMove()];
}

function lastPlayer() {
  // Who moved last time?
  return lastMove() % 2 + 1;
}

function drawMove() {
  // Draw the latest move on the board (in the correct position for
  // correct player
  var text = "X";
  if (lastPlayer() === 2) {
    text = "O";
  }
  var box = document.querySelector('.box.x' + lastPosition() + '');
  box.textContent = text;
  addMessage("Draw move.", "level4");
}

function randomMove() {
  // Generate a move on the board (random position from 1 to 9)
  // TODO: return only valid move (not already filled)
  var res = getRandomInt(1, 9);
  console.log(res);
  addMessage("Random move.", "level3");
  return res;
}

function simulateMove() {
  // Get a random move and put it on the board
  addMessage("Simulate move.", "level2");
  var move = randomMove();
  window.game.push(move);
  drawMove();
  console.log(window.game);
}

function simulateGame() {
  // Repeat get random move until the game is finished
  // TODO: implement Game Over
  addMessage("Starting game...", "level1");
  window.game = [];
  simulateMove();
  simulateMove();
  simulateMove();
  simulateMove();
  simulateMove();
  simulateMove();
  simulateMove();
  simulateMove();
  simulateMove();
}

function trainComputer() {
  // To be used before playing with computer. It simulates a number of games,
  // saves them in the history, to be used for later better moves.
  simulateGame();
  simulateGame();
}

// Start
trainComputer();
    </script>
    <style>
body {
  background: #111;
}

.container {
  background: #444;
  width: 600px;
  margin: auto;
}

.box {
  background: #333;
  width: 180px;
  height: 180px;
  float: left;
  border: 10px solid #111;
  font-size: 150px;
  color: white;
  text-align: center;
}

.console {
  padding: 10px;
  max-height: 250px;
  background: #333;
  overflow: auto;
}

.level1 {
  color: #FFF;
}

.level2 {
  color: #DDD;
}

.level3 {
  color: #BBB;
}

.level4 {
  color: #888;
}

.level5 {
  color: #555;
}
    </style>
  </body>
</html>
